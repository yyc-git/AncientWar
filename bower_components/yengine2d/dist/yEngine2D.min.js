/*!
 yEngine2D
 2D HTML5 Game Engine

 version: 0.1.1
 author: YYC
 email: 395976266@qq.com
 qq: 395976266
 blog: http://www.cnblogs.com/chaogex/
 homepage: 
 repository: https://github.com/yyc-git/YEngine2D
 license: MIT
 date: 2014-11-16
*/
!function(){function a(a,b){var c="";for(c in b)a[c]=b[c];return a}function b(){this.ye_container=[]}b.prototype={ye_loadJsSync:function(a,b){var c=null;c=this.ye_createScript(a),this.ye_appendScript(c),this.ye_onloadSync(a,c,b)},ye_appendScript:function(a){var b=document.getElementsByTagName("head")[0];b.appendChild(a)},ye_createScript:function(a){var b=document.createElement("script");return b.type="text/javascript",b.src=a.src,b},ye_onloadSync:function(a,b,c){var d=this;b.readyState?b.onreadystatechange=function(){("loaded"==b.readyState||"complete"==b.readyState)&&(b.onreadystatechange=null,a.callback&&a.callback.apply(a.obj,a.args),d.ye_loadNext(c))}:b.onload=function(){a.callback&&a.callback.apply(a.obj,a.args),d.ye_loadNext(c)}},ye_loadNext:function(a){return 0==this.ye_container.length?void this.onload():void a.call(this,null)},onload:function(){},add:function(a,b,c,d){return this.ye_container.push({src:a,callback:b,args:c||[],obj:d?d:window}),this},loadSync:function(){var a=null;if(0==this.ye_container.length)throw new Error("请先加入js");a=this.ye_container.shift(),this.ye_loadJsSync(a,this.loadSync)}},b.create=function(){return new this},function(){var b={namespace:function(a){var b=window,c=a.split("."),d=0,e=0;for(0==a.length&&YE.error(!0,"命名空间不能为空"),d=0,e=c.length;e>d;d++)"undefined"==typeof b[c[d]]&&(b[c[d]]={}),b=b[c[d]];return b}};a(window,b)}(),namespace("YE"),function(){function a(a){YE.$("body").prepend("<div style='color:red;font-size: 20;'>引擎调试信息："+a+"</div>")}YE.returnForTest="YEngine2D_testReturn",YE.log=function(b){YE.main.getConfig().isDebug&&(YE.main.getConfig().isShowDebugOnPage?a(b):console.log&&console.log(b))},YE.assert=function(a,b){YE.main.getConfig().isDebug&&(console.assert?console.assert(a,b):!a&&b&&(console&&console.log?console.log("断言："+b):alert("断言："+b)))},YE.error=function(a,b){if(a)throw new Error(b)}}(),YE.main={ye_config:{isDebug:!1,isShowDebugOnPage:!1,isAutoLoadWhenDomReady:!0,engineDir:"",isSingleEngineFile:!0,userFilePaths:[],onload:function(){}},ye_engineFilePaths:["import/yeQuery.js","import/jsExtend.js","import/YSound.js","tool/Tool.js","base/Entity.js","base/Node.js","base/NodeContainer.js","base/CollectionManager.js","structure/Hash.js","structure/Collection.js","structure/Geometry.js","structure/Bitmap.js","algorithm/collision.js","algorithm/AStar.js","loader/Loader.js","loader/ImgLoader.js","loader/JsonLoader.js","loader/SoundLoader.js","loader/LoaderManager.js","sound/SoundManager.js","core/Director.js","core/Scene.js","core/Layer.js","core/Sprite.js","event/Event.js","event/EventManager.js","animation/AnimationFrame.js","animation/Animation.js","animation/Frame.js","animation/FrameCache.js","animation/AnimationManager.js","animation/AnimationFrameManager.js","animation/AnimationCache.js","action/Action.js","action/ActionInterval.js","action/ActionInstant.js","action/Control.js","action/Animate.js","action/ActionManager.js","action/Repeat.js","action/RepeatForever.js","action/RepeatCondition.js","action/Sequence.js","action/Spawn.js","action/CallFunc.js","action/DelayTime.js","action/MoveBy.js","action/JumpBy.js","action/Place.js","ui/Graphics.js"],ye_isLoaded:!1,ye_loadJsLoader:function(){var a=this.ye_engineFilePaths,c=this.ye_config.engineDir,d=this.ye_config.userFilePaths,e=this.ye_config.onload,f=b.create();this.ye_isLoaded=!0,f.onload=e,this.ye_config.isSingleEngineFile||a.forEach(function(a){f.add(c+a)}),d.forEach(function(a){f.add(a)}),f.loadSync()},setConfig:function(b){var c=this;a(this.ye_config,b),this.ye_config.isAutoLoadWhenDomReady&&window.addEventListener("DOMContentLoaded",function(){c.ye_loadJsLoader()})},getConfig:function(){return this.ye_config},load:function(){return this.ye_config.isAutoLoadWhenDomReady?(YE.log("已配置为DOM加载完成后自动加载文件，此处不再进行加载"),!1):this.ye_isLoaded?(YE.log("已经加载过文件了，不能重复加载"),!1):void this.ye_loadJsLoader()},forTest_getJsLoader:function(){return b}}}(),function(){function a(a){return"[object Array]"===Object.prototype.toString.call(a)}function b(a){return"[object Function]"===Object.prototype.toString.call(a)}var c=this;!function(){String.prototype.contain=function(a){return this.indexOf(a)>=0},String.prototype.containIgnoreCase=function(a){return this.toLowerCase().indexOf(a.toLowerCase())>=0},String.prototype.trim=function(){return this.replace(/^\s*/g,"").replace(/\s*$/g,"")}}(),function(){c.$break={},Array.prototype.forEach=function(a,b){for(var d=b||c,e=0,f=this.length;f>e&&a.call(d,this[e],e)!==$break;++e);},Array.prototype.filter=function(a,b){var d=b||c,e=this,f=[];return this.forEach(function(b,c){a.call(d,b,c,e)&&f.push(b)}),f},Array.prototype.pushNoRepeat=function(a){this.contain(function(b){return b===a?!0:!1})||this.push(a)},Array.prototype.removeChild=function(a){var b=this,c=null;return c=this.indexOf(function(c){return!!a.call(b,c)}),null!==c&&-1!==c?(this.splice(c,1),!0):!1},Array.prototype.map=function(b,c){if(c&&!a(c))throw new Error("参数必须为数组");this.forEach(function(a){a&&a[b]&&a[b].apply(a,c)})},Array.prototype.contain=function(a){var c=!1;return this.forEach(b(a)?function(b,d){return a.call(null,b,d)?(c=!0,$break):void 0}:function(b){return a===b||b.contain&&b.contain(a)?(c=!0,$break):void 0}),c},Array.prototype.indexOf=function(a){var b=-1,c=null;return this.forEach(function(d,e){return c=a.call(null,d,e),c?(b=e,$break):void 0}),b}}()}(),function(){var yeQuery=function(){function _isString(a){return"string"==typeof a}function _buildDom(a){if(_isString(a)){var b=document.createElement("div");return b.innerHTML=a,b.firstChild}return a}function YEQuery(a){return this.ye_doms=document.querySelectorAll(a),this instanceof YEQuery?void 0:new YEQuery(a)}return YEQuery.ajax=function(error){function ajax(conf){var type=conf.type,url=conf.url,data=conf.data,dataType=conf.dataType,success=conf.success,error=conf.error,xhr=null;if(null===type&&(type="get"),null===dataType&&(dataType="text"),xhr=_createAjax(error))try{xhr.open(type,url,!0),_isSoundFile(dataType)&&(xhr.responseType="arraybuffer"),"GET"===type||"get"===type?xhr.send(null):("POST"===type||"post"===type)&&(xhr.setRequestHeader("content-type","application/x-www-form-urlencoded"),xhr.send(data)),xhr.onreadystatechange=function(){4!==xhr.readyState||200!==xhr.status&&!_isLocalFile(xhr.status)||("text"===dataType||"TEXT"===dataType?null!==success&&success(xhr.responseText):"xml"===dataType||"XML"===dataType?null!==success&&success(xhr.responseXML):"json"===dataType||"JSON"===dataType?null!==success&&success(eval("("+xhr.responseText+")")):_isSoundFile(dataType)&&null!==success&&success(xhr.response))}}catch(e){error(xhr,e)}}function _createAjax(a){var b=null;try{b=new ActiveXObject("microsoft.xmlhttp")}catch(c){try{b=new XMLHttpRequest}catch(d){return a(b,{message:"您的浏览器不支持ajax，请更换！"}),null}}return b}function _isLocalFile(a){return document.URL.contain("file://")&&0===a}function _isSoundFile(a){return"arraybuffer"===a}return ajax}(),YEQuery.prototype={get:function(a){return this.ye_doms[a]},prepend:function(a){var b=null,c=0,d=0;for(b=_buildDom(a),c=0,d=this.ye_doms.length;d>c;c++)1===this.ye_doms[c].nodeType&&this.ye_doms[c].insertBefore(b,this.ye_doms[c].firstChild);return this}},YEQuery}();YE.$=yeQuery}(),function(){YE.Entity=YYC.AClass({Init:function(){this.ye_entity_addUid(),this.ye_entity_cacheData=YE.Hash.create()},Private:{ye_entity_uid:0,ye_entity_cacheData:null,ye_entity_tag:null,ye_entity_addUid:function(){this.ye_entity_uid=YE.Entity.count++}},Public:{setCacheData:function(a,b){this.ye_entity_cacheData.addChild(a,b)},getCacheData:function(a){return this.ye_entity_cacheData.getValue(a)},getUid:function(){return this.ye_entity_uid},setTag:function(a){this.ye_entity_tag=YE.Tool.judge.isArray(a)?a:[a]},addTag:function(a){return null===this.ye_entity_tag?void this.setTag(a):void this.ye_entity_tag.push(a)},removeTag:function(a){null!==this.ye_entity_tag&&this.ye_entity_tag.removeChild(function(b){return b===a})},getTag:function(){return this.ye_entity_tag},hasTag:function(a){return this.ye_entity_tag&&(this.ye_entity_tag===a||this.ye_entity_tag.contain(function(b){return b===a}))},containTag:function(a){return this.ye_entity_tag?this.ye_entity_tag.contain(a):void 0}},Static:{count:1}})}(),function(){YE.Node=YYC.AClass(YE.Entity,{Private:{ye_parent:null,ye_zOrder:0,ye_setZOrder:function(a){this.ye_zOrder=a}},Public:{getParent:function(){return this.ye_parent},getZOrder:function(){return this.ye_zOrder},Virtual:{init:function(a){this.ye_parent=a},onStartLoop:function(){},onEndLoop:function(){},onEnter:function(){},onExit:function(){}}}})}(),function(){YE.CollectionManager=YYC.AClass(YE.Entity,{Init:function(){this.ye_P_childs=YE.Collection.create()},Private:{},Protected:{ye_P_childs:null},Public:{update:function(){var a=this,b=[],c=null;c=1/YE.Director.getInstance().getFps(),this.ye_P_childs.forEach(function(a){return a?a.isFinish()?void b.push(a):void(a.isStop()||a.update(c)):void 0}),b.forEach(function(b){a.removeChild(b)})},getCount:function(){return this.ye_P_childs.getCount()},addChild:function(a,b){a.setTarget(b),this.ye_P_childs.addChild(a),a.init(),a.onEnter()},removeChild:function(a,b){a.onExit(),b===!0&&a.reset(),this.ye_P_childs.removeChild(function(b){return a.getUid()===b.getUid()})},removeAllChilds:function(a){this.ye_P_childs.map("onExit"),a===!0&&this.ye_P_childs.map("reset"),this.ye_P_childs.removeAllChilds()},hasChild:function(a){var b=null;return a?YE.Tool.judge.isString(arguments[0])?(b=arguments[0],this.ye_P_childs.hasChild(function(a){return a.hasTag(b)})):this.ye_P_childs.hasChild(a):!1},getChilds:function(){return this.ye_P_childs.getChilds()}}})}(),function(){YE.NodeContainer=YYC.AClass(YE.Node,{Init:function(){this.base(),this.ye__childs=YE.Collection.create()},Private:{ye__isChangeZOrder:!1,ye__childs:null},Protected:{Abstract:{ye_P_run:function(){}}},Public:{isSortAllChilds:!0,reorderChild:function(a,b){this.ye__isChangeZOrder=!0,a.ye_setZOrder(b)},sortByZOrder:function(){this.ye__isChangeZOrder&&(this.ye__isChangeZOrder=!1,this.sort(function(a,b){return a.getZOrder()-b.getZOrder()}))},sort:function(a){this.ye__childs.sort(a)},getChilds:function(){return this.ye__childs.getChilds()},getChildAt:function(a){return this.ye__childs.getChildAt(a)},addChilds:function(a,b,c){var d=this;YE.error(!YE.Tool.judge.isArray(a),"第一个参数必须为数组"),b&&(this.ye__isChangeZOrder=!0),this.ye__childs.addChilds(a),a.forEach(function(a){b&&a.ye_setZOrder(b),c&&a.addTag(c),a.init(d),a.onEnter()})},addChild:function(a,b,c){this.ye__childs.addChild(a),b&&(this.ye__isChangeZOrder=!0,a.ye_setZOrder(b)),c&&a.addTag(c),a.init(this),a.onEnter()},hasChild:function(a){return this.ye__childs.hasChild(a)},getChildByTag:function(a){return YE.Tool.collection.getChildByTag(this.ye__childs,a)},getChildsByTag:function(a){return YE.Tool.collection.getChildsByTag(this.ye__childs,a)},removeChildByTag:function(a){YE.Tool.collection.removeChildByTag(this.ye__childs,a,function(a){a.onExit()})},removeChildsByTag:function(a){YE.Tool.collection.removeChildsByTag(this.ye__childs,a,function(a){a.onExit()})},removeChild:function(a){a.onExit(),this.ye__childs.removeChild(a)},removeAllChilds:function(){this.ye__childs.map("onExit"),this.ye__childs.removeAllChilds()},iterate:function(){YE.Tool.judge.isFunction(arguments[0])?this.ye__childs.forEach.apply(this.ye__childs,arguments):this.ye__childs.map.apply(this.ye__childs,arguments)},run:function(){this.isSortAllChilds&&this.sortByZOrder(),this.ye_P_run()}}})}(),function(){YE.Action=YYC.AClass(YE.Entity,{Init:function(){this.base(),this.ye_isFinish=!1},Private:{ye_target:null,ye_isFinish:null},Public:{setTarget:function(a){this.ye_target=a},getTarget:function(){return this.ye_target},isStart:function(){return!this.isStop()},isFinish:function(){return this.ye_isFinish},reset:function(){this.ye_isFinish=!1},finish:function(){this.ye_isFinish=!0,this.stop()},Virtual:{init:function(){},onEnter:function(){},onExit:function(){}}},Abstract:{update:function(){},copy:function(){},start:function(){},stop:function(){},isStop:function(){},reverse:function(){}}})}(),function(){YE.ActionInstant=YYC.AClass(YE.Action,{Public:{isStop:function(){return!1},start:function(){},stop:function(){}}})}(),function(){YE.ActionInterval=YYC.AClass(YE.Action,{Init:function(){this.base()},Private:{ye__isStop:!1},Public:{start:function(){this.ye__isStop=!1},reset:function(){this.base(),this.ye__isStop=!1},stop:function(){this.ye__isStop=!0},isStop:function(){return this.ye__isStop}}})}(),function(){YE.Control=YYC.AClass(YE.ActionInterval,{Init:function(){this.base()},Protected:{Virtual:{ye_P_iterate:function(){var a=this.getInnerActions();a.map.apply(a,arguments)}}},Public:{init:function(){this.ye_P_iterate("init")},onEnter:function(){this.ye_P_iterate("onEnter")},onExit:function(){this.ye_P_iterate("onExit")},setTarget:function(a){this.base(a),this.ye_P_iterate("setTarget",[a])},reverse:function(){return this.ye_P_iterate("reverse"),this},reset:function(){this.base(),this.ye_P_iterate("reset")}},Abstract:{getInnerActions:function(){}}})}(),function(){YE.Loader=YYC.AClass(YE.Entity,{Init:function(){this.base(),this.ye_P_container=YE.Hash.create(),this.ye_loadedUrl=YE.Collection.create()},Private:{ye_loadedUrl:null},Protected:{ye_P_container:null,Abstract:{ye_P_load:function(){}}},Public:{get:function(a){return this.ye_P_container.getValue(a)},load:function(a,b){var c=b?b:a;return this.ye_loadedUrl.hasChild(a)?(YE.LoaderManager.getInstance().onResLoaded(),this.get(c)):(this.ye_loadedUrl.addChild(a),void this.ye_P_load(a,c))}}})}(),function(){YE.ActionManager=YYC.Class(YE.CollectionManager,{Init:function(){this.base()},Public:{getChildByTag:function(a){return YE.Tool.collection.getChildByTag(this.ye_P_childs,a)},getChildsByTag:function(a){return YE.Tool.collection.getChildsByTag(this.ye_P_childs,a)},removeChildByTag:function(a,b){YE.Tool.collection.removeChildByTag(this.ye_P_childs,a,function(a){a.onExit(),b&&a.reset()})},removeChildsByTag:function(a,b){YE.Tool.collection.removeChildsByTag(this.ye_P_childs,a,function(a){a.onExit(),b&&a.reset()})}},Static:{create:function(){return new this}}})}(),function(){YE.Animate=YYC.Class(YE.ActionInterval,{Init:function(a){this.base(),this.ye___anim=a},Private:{ye___anim:null,ye___frames:null,ye___frameCount:-1,ye___duration:0,ye___currentFrameIndex:-1,ye___currentFramePlayed:-1,ye___currentFrame:null,ye___setCurrentFrame:function(a){this.ye___currentFrameIndex=a,this.ye___setFrame(this.ye___frames.getChildAt(a)),this.ye___currentFramePlayed=0},ye___setFrame:function(a){this.ye___currentFrame=a}},Public:{initWhenCreate:function(){this.ye___frames=YE.Collection.create(),this.ye___frames.addChilds(this.ye___anim.getFrames()),this.ye___duration=this.ye___anim.getDurationPerFrame(),this.ye___frameCount=this.ye___frames.getCount(),this.ye___anim.setFrameIndex(this.ye___anim.getFrames()),this.ye___setCurrentFrame(0)},update:function(a){if(this.ye___currentFramePlayed>=this.ye___duration){if(this.ye___currentFrameIndex>=this.ye___frameCount-1)return this.finish(),YE.returnForTest;this.ye___currentFrameIndex++,this.ye___setCurrentFrame(this.ye___currentFrameIndex)}else this.ye___currentFramePlayed+=a;this.ye___currentFrame.setCacheData("animSize",this.ye___anim.getAnimSize()),this.getTarget().setDisplayFrame(this.ye___currentFrame)},reset:function(){this.base(),this.ye___setCurrentFrame(0)},copy:function(){return YE.Animate.create(this.ye___anim.copy())},reverse:function(){return this.ye___frames.reverse(),this.ye___anim.setFrameIndex(this.ye___frames.getChilds()),this.ye___setFrame(this.ye___frames.getChildAt(this.ye___currentFrameIndex)),this}},Static:{create:function(a){var b=new this(a);return b.initWhenCreate(),b}}})}(),function(){YE.CallFunc=YYC.Class(YE.ActionInstant,{Init:function(a,b,c){this.base(),this.ye___context=b||window,this.ye___callFunc=a,this.ye___dataArr=c},Private:{ye___context:null,ye___callFunc:null,ye___dataArr:null},Public:{reverse:function(){return this},update:function(){this.ye___callFunc&&this.ye___callFunc.call(this.ye___context,this.getTarget(),this.ye___dataArr),this.finish()},copy:function(){return new YE.CallFunc(this.ye___context,this.ye___callFunc,YE.Tool.extend.extendDeep(this.ye___dataArr))}},Static:{create:function(a,b){var c=Array.prototype.slice.call(arguments,2),d=new this(a,b,c);return d}}})}(),function(){YE.DelayTime=YYC.Class(YE.ActionInterval,{Init:function(a){this.base(),this.___delayTime=a},Private:{___delayTime:-1,___elapsed:-1,___firstTick:!0},Public:{reverse:function(){return this},update:function(a){return this.___firstTick?(this.___firstTick=!1,this.___elapsed=0,YE.returnForTest):(this.___elapsed+=a,void(this.___elapsed>=this.___delayTime&&this.finish()))},copy:function(){return YE.DelayTime.create(this.___delayTime)}},Static:{create:function(a){var b=new this(a);return b}}})}(),function(){YE.JumpBy=YYC.Class(YE.ActionInterval,{Init:function(a,b,c,d){this.base(),this.ye___duration=a,this.ye___x=b,this.ye___y=c,this.ye___height=d},Private:{ye___elapsed:0,ye___topY:0,ye___topX:0,ye___x:0,ye___y:0,ye___destX:0,ye___destY:0,ye___posX:0,ye___posY:0,ye___directionX:null,ye___directionY:null,ye___isFinish:function(){return this.ye___elapsed>=this.ye___duration},ye___computeTotalDistance:function(){this.ye___totalX=Math.abs(this.ye___x),this.ye___totalY=2*this.ye___height+Math.abs(this.ye___y)},ye___computeDestPos:function(){this.ye___destX=this.ye___posX+this.ye___x,this.ye___destY=this.ye___posY+this.ye___y},ye___initDirection:function(){this.ye___directionY=0===this.ye___height&&this.ye___y>0?"down":"up",this.ye___directionX=this.ye___x>0?"right":"left"},ye___savePosition:function(){var a=null;a=this.getTarget(),this.ye___posX=a.getPositionX(),this.ye___posY=a.getPositionY()},ye___computeTopY:function(){this.ye___topY=Math.min(this.ye___posY,this.ye___posY+this.ye___y)-this.ye___height},ye___setTargetToDest:function(){this.getTarget().setPosition(this.ye___destX,this.ye___destY)},ye___computeMoveDistance:function(a){var b=null,c=null,d=null;return b=a/this.ye___duration,c=b*this.ye___totalX,d=b*this.ye___totalY,[c,d]},ye___setPosX:function(a){"left"===this.ye___directionX?this.ye___posX-=a:this.ye___posX+=a,this.getTarget().setPositionX(this.ye___posX)},ye___setPosY:function(a){"up"===this.ye___directionY?(this.ye___posY-=a,this.ye___isJumpOverTopPoint()&&this.ye___enterDownProcess()):"down"===this.ye___directionY&&(this.ye___posY+=a),this.getTarget().setPositionY(this.ye___posY)},ye___isJumpOverTopPoint:function(){return this.ye___posY<=this.ye___topY},ye___enterDownProcess:function(){this.ye___directionY="down",this.ye___posY=this.ye___topY+(this.ye___topY-this.ye___posY)}},Public:{initWhenCreate:function(){YE.error(this.ye___height<0,"高度必须为非负值"),this.ye___computeTotalDistance(),this.ye___initDirection()},init:function(){this.ye___savePosition(),this.ye___computeTopY(),this.ye___computeDestPos()},update:function(a){var b=null,c=null;return b=this.getTarget(),this.ye___isFinish()?(this.finish(),void this.ye___setTargetToDest()):(c=this.ye___computeMoveDistance(a),this.ye___setPosX(c[0]),this.ye___setPosY(c[1]),void(this.ye___elapsed+=a))},copy:function(){return YE.JumpBy.create(this.ye___duration,this.ye___x,this.ye___y,this.ye___height)},reverse:function(){return YE.JumpBy.create(this.ye___duration,-this.ye___x,-this.ye___y,this.ye___height)}},Static:{create:function(a,b,c,d){var e=new this(a,b,c,d);return e.initWhenCreate(),e}}})}(),function(){YE.MoveBy=YYC.Class(YE.ActionInterval,{Init:function(a,b,c){this.base(),this.ye___duration=a,this.ye___x=b,this.ye___y=c},Private:{ye___elapsed:0,ye___duration:null,ye___x:null,ye___y:null,ye___destX:null,ye___destY:null,ye___computeDestPos:function(){var a=null;a=this.getTarget(),this.ye___destX=a.getPositionX()+this.ye___x,this.ye___destY=a.getPositionY()+this.ye___y},ye___computeMoveDistance:function(a){var b=null,c=null,d=null;return b=a/this.ye___duration,c=b*this.ye___x,d=b*this.ye___y,[c,d]},ye___isFinish:function(){return this.ye___elapsed>=this.ye___duration},ye___setTargetToDest:function(){this.getTarget().setPosition(this.ye___destX,this.ye___destY)}},Public:{init:function(){this.ye___computeDestPos()},update:function(a){var b=null,c=null;return b=this.getTarget(),this.ye___isFinish()?(this.finish(),void this.ye___setTargetToDest()):(c=this.ye___computeMoveDistance(a),b.setPositionX(b.getPositionX()+c[0]),b.setPositionY(b.getPositionY()+c[1]),void(this.ye___elapsed+=a))},copy:function(){return YE.MoveBy.create(this.ye___duration,this.ye___x,this.ye___y)},reverse:function(){return YE.MoveBy.create(this.ye___duration,-this.ye___x,-this.ye___y)}},Static:{create:function(a,b,c){var d=new this(a,b,c);return d}}})}(),function(){YE.Place=YYC.Class(YE.ActionInstant,{Init:function(a,b){this.base(),this.ye___posX=a,this.ye___posY=b},Private:{ye___posX:null,ye___posY:null},Public:{update:function(){var a=null;a=this.getTarget(),a.setPositionX(this.ye___posX),a.setPositionY(this.ye___posY),this.finish()},copy:function(){return YE.Place.create(this.ye___posX,this.ye___posY)},reverse:function(){return this.ye___posX=-this.ye___posX,this.ye___posY=-this.ye___posY,this}},Static:{create:function(a,b){var c=new this(a,b);return c}}})}(),function(){YE.Repeat=YYC.Class(YE.Control,{Init:function(a,b){this.base(),this.ye____innerAction=a,this.ye____times=b},Private:{ye____innerAction:null,ye____originTimes:0,ye____times:0},Public:{initWhenCreate:function(){this.ye____originTimes=this.ye____times},update:function(a){return 0===this.ye____times?void this.finish():(this.ye____innerAction.update(a),void(this.ye____innerAction.isFinish()&&(this.ye____times-=1,0!==this.ye____times&&this.ye____innerAction.reset())))},copy:function(){return YE.Repeat.create(this.ye____innerAction.copy(),this.ye____times)},reset:function(){this.base(),this.ye____times=this.ye____originTimes},start:function(){this.base(),this.ye____innerAction.start()},stop:function(){this.base(),this.ye____innerAction.stop()},getInnerActions:function(){return[this.ye____innerAction]}},Static:{create:function(a,b){var c=new this(a,b);return c.initWhenCreate(),c}}})}(),function(){YE.RepeatCondition=YYC.Class(YE.Control,{Init:function(a,b,c){this.base(),this.ye____innerAction=a,this.ye____context=b||window,this.ye____conditionFunc=c},Private:{ye____innerAction:null,ye____context:null,ye____conditionFunc:null},Public:{initWhenCreate:function(){YE.error(!this.ye____conditionFunc,"必须传入重复条件")},update:function(a){return!!this.ye____conditionFunc.call(this.ye____context)==!1||this.ye____innerAction.isFinish()?void this.finish():void this.ye____innerAction.update(a)},copy:function(){return YE.RepeatCondition.create(this.ye____innerAction.copy(),this.ye____context,this.ye____conditionFunc)},start:function(){this.base(),this.ye____innerAction.start()},stop:function(){this.base(),this.ye____innerAction.stop()},getInnerActions:function(){return[this.ye____innerAction]}},Static:{create:function(a,b,c){var d=new this(a,b,c);return d.initWhenCreate(),d}}})}(),function(){YE.RepeatForever=YYC.Class(YE.Control,{Init:function(a){this.base(),this.ye____innerAction=a},Private:{ye____innerAction:null},Public:{update:function(a){this.ye____innerAction.update(a),this.ye____innerAction.isFinish()&&this.ye____innerAction.reset()},isFinish:function(){return!1},copy:function(){return YE.RepeatForever.create(this.ye____innerAction.copy())},start:function(){this.base(),this.ye____innerAction.start()},stop:function(){this.base(),this.ye____innerAction.stop()},getInnerActions:function(){return[this.ye____innerAction]}},Static:{create:function(a){var b=new this(a);return b}}})}(),function(){YE.Sequence=YYC.Class(YE.Control,{Init:function(){this.base()},Private:{ye____actions:null,ye____currentAction:null,ye____actionIndex:-1},Public:{initWhenCreate:function(a){this.ye____actions=YE.Collection.create(),this.ye____actions.addChilds(a),this.ye____currentAction=this.ye____actions.getChildAt(0),this.ye____actionIndex=0},update:function(a){return this.ye____actionIndex===this.ye____actions.getCount()?void this.finish():(this.ye____currentAction=this.ye____actions.getChildAt(this.ye____actionIndex),this.ye____currentAction.isFinish()?(this.ye____actionIndex+=1,void this.update(a)):(this.ye____currentAction.update(a),YE.returnForTest))},copy:function(){var a=[];return this.ye____actions.forEach(function(b){a.push(b.copy())}),YE.Sequence.create.apply(YE.Sequence,a)},reverse:function(){return this.ye____actions.reverse(),this.base(),this},reset:function(){this.base(),this.ye____actionIndex=0,this.ye____actions.map("reset")},start:function(){this.base(),this.ye____currentAction.start()},stop:function(){this.base(),this.ye____currentAction.stop()},getInnerActions:function(){return this.ye____actions}},Static:{create:function(){var a=null,b=null;return YE.assert(arguments.length>=2,"应该有2个及以上动作"),a=Array.prototype.slice.call(arguments,0),b=new this,b.initWhenCreate(a),b}}})}(),function(){YE.Spawn=YYC.Class(YE.Control,{Init:function(a){this.base(),this.ye____actions=a},Private:{ye____actions:null,ye____isFinish:function(){var a=!0;return this.ye____actions.forEach(function(b){return b.isFinish()?void 0:(a=!1,$break)}),a},ye____iterate:function(a,b){this.ye____actions.forEach(function(c){c.isFinish()||c[a].apply(c,b)})}},Public:{update:function(a){this.ye____isFinish()&&this.finish(),this.ye____iterate("update",[a])},start:function(){this.base(),this.ye_P_iterate("start")},copy:function(){var a=[];return this.ye____actions.forEach(function(b){a.push(b.copy())}),YE.Spawn.create.apply(YE.Spawn,a)},reverse:function(){return this.ye____actions.reverse(),this.base(),this},stop:function(){this.base(),this.ye_P_iterate("stop")},reset:function(){this.base(),this.ye_P_iterate("reset")},getInnerActions:function(){return this.ye____actions}},Static:{create:function(){var a=null;return YE.assert(arguments.length>=2,"应该有2个及以上动作"),a=new this(Array.prototype.slice.call(arguments,0))}}})}(),function(){function a(a,e,f){var q=null,r=new Date,s=null,x=null,y=null,z=null,A=null,B=[],C=[],D=0,E=[],q=r.getTime();w=a.length,t=c(a),x=e[0],y=w-1-e[1],z=f[0],A=w-1-f[1];var F=d(x,y),G=d(z,A);if(t[G]&&0==t[G][0])return s=b(q),{path:[],time:s,info:"目的地无法到达"};if(0==t[F][0])return s=b(q),{path:[],time:s,info:"起始点不可用"};if(t[G]&&t[G][0]*t[F][0]==1){for(t[F]=[t[F][0],F,t[F][2],t[F][3],t[F][4]],g(G),j(F);0!=u.length;){var H=i(u);if(D=0,u.shift(),k(H),H==G){p(v,C,B);break}var I,J=0,K=0,L=new Array;for(L=o(G,w),K;9>K;K++){if(8==K){I=0;break}if(1==L[K][0]){I=1;break}}if(0==I)return s=b(q),{path:[],time:s,info:"目标成孤岛"};for(E=o(H,w),J;8>J;J++)0==E[J][0]||m(E[J][4])||(1==l(E[J][4])&&E[J][2]>=t[H][2]+n(E[J],H)&&(h(E[J][4],H),t[E[J][4]]=E[J]=[t[E[J][4]][0],H,t[E[J][4]][2],t[E[J][4]][3],t[E[J][4]][4]]),0==l(E[J][4])&&(h(E[J][4],H),t[E[J][4]]=E[J]=[t[E[J][4]][0],H,t[E[J][4]][2],t[E[J][4]][3],t[E[J][4]][4]],j(E[J][4])));if(D++,D==w*w*1e3)return s=b(q),{path:[],time:s,info:"找不到路径"}}if(0==u.length&&H!=G)return s=b(q),{path:[],time:s,info:"找不到路径"}}return s=b(q),{path:B,time:s}}function b(a){var b=(new Date).getTime();return(b-a)/1e3}function c(a){var b=w*w,c=new Array,d=b-1;for(d;d>=0;d--){var g=e(d),h=w-1-f(d);c[d]=a[h][g]==r?[1,0,0,0,d]:[0,0,0,0,d]}return c}function d(a,b){return b*w+a}function e(a){return parseInt(a%w)}function f(a){return parseInt(a/w)}function g(a){var b=e(a),c=f(a),d=0;for(d;d<t.length;d++){var g=e(d),h=f(d),i=Math.max(Math.abs(parseInt(b)-parseInt(g)),Math.abs(parseInt(c)-parseInt(h)));t[d][3]=i*parseInt(10)}}function h(a,b){var c=e(b),d=f(b),g=e(a),h=f(a);t[a]=c-g==0||d-h==0?[t[a][0],t[a][1],t[a][2]+parseInt(10),t[a][3],t[a][4]]:[t[a][0],t[a][1],t[a][2]+parseInt(14),t[a][3],t[a][4]]}function i(a){var b,c,d,e;for(b=0;b<a.length;b++)for(c=b+1;c<a.length;c++)a[b][2]+a[b][3]>a[c][2]+a[c][3]&&(e=a[b],a[b]=a[c],a[c]=e);var d=a[0];return d[4]}function j(a){var b=u.length;u[b]=[t[a][0],t[a][1],t[a][2],t[a][3],t[a][4]]}function k(a){var b=v.length;v[b]=[t[a][0],t[a][1],t[a][2],t[a][3],t[a][4]]}function l(a){var b;for(b=0;b<u.length;b++)if(u[b][4]==a)return 1;return 0}function m(a){var b;for(b=0;b<v.length;b++)return v[b][4]==a?1:0}function n(a,b){var c=e(b),d=f(b),g=e(a),h=f(a);return c-g==0||d-h==0?10:14}function o(a,b){var c=e(a),g=f(a),h=b-1,i=[];return i[1]=c-1>=0&&g>=0&&h>=c-1&&h>=g?[t[d(c-1,g)][0],t[d(c-1,g)][1],t[d(c-1,g)][2],t[d(c-1,g)][3],t[d(c-1,g)][4]]:[0,0,0,0,0],i[3]=c>=0&&g+1>=0&&h>=c&&h>=g+1?[t[d(c,g+1)][0],t[d(c,g+1)][1],t[d(c,g+1)][2],t[d(c,g+1)][3],t[d(c,g+1)][4]]:[0,0,0,0,0],i[4]=c>=0&&g-1>=0&&h>=c&&h>=g-1?[t[d(c,g-1)][0],t[d(c,g-1)][1],t[d(c,g-1)][2],t[d(c,g-1)][3],t[d(c,g-1)][4]]:[0,0,0,0,0],i[6]=c+1>=0&&g>=0&&h>=c+1&&h>=g?[t[d(c+1,g)][0],t[d(c+1,g)][1],t[d(c+1,g)][2],t[d(c+1,g)][3],t[d(c+1,g)][4]]:[0,0,0,0,0],8==s&&(i[0]=c-1>=0&&g+1>=0&&h>=c-1&&h>=g+1?[t[d(c-1,g+1)][0],t[d(c-1,g+1)][1],t[d(c-1,g+1)][2],t[d(c-1,g+1)][3],t[d(c-1,g+1)][4]]:[0,0,0,0,0],i[2]=c-1>=0&&g-1>=0&&h>=c-1&&h>=g-1?[t[d(c-1,g-1)][0],t[d(c-1,g-1)][1],t[d(c-1,g-1)][2],t[d(c-1,g-1)][3],t[d(c-1,g-1)][4]]:[0,0,0,0,0],i[5]=c+1>=0&&g+1>=0&&h>=c+1&&h>=g+1?[t[d(c+1,g+1)][0],t[d(c+1,g+1)][1],t[d(c+1,g+1)][2],t[d(c+1,g+1)][3],t[d(c+1,g+1)][4]]:[0,0,0,0,0],i[7]=c+1>=0&&g-1>=0&&h>=c+1&&h>=g-1?[t[d(c+1,g-1)][0],t[d(c+1,g-1)][1],t[d(c+1,g-1)][2],t[d(c+1,g-1)][3],t[d(c+1,g-1)][4]]:[0,0,0,0,0]),4==s&&(i[0]=[0,0,0,0,0],i[2]=[0,0,0,0,0],i[5]=[0,0,0,0,0],i[7]=[0,0,0,0,0]),i}function p(a,b,c){var d=a.length,g=d-1,h=0,i=new Array,j=null;for(h;i[h]=a[d-1][4],a[d-1][1]!=a[g][4];h++)for(g=d-1;g>=0;g--)if(a[g][4]==a[d-1][1]){d=g+1;break}for(var k=i.length-1,l=0,g=k;g>=0;g--)b[l]=i[g],l++;for(var m=0;k>=m;m++)j=[e(b[m]),w-1-f(b[m])],c.push(j);c.shift()}function q(){t=[],w=null,u=[],v=[]}var r=0,s=4,t=[],u=[],v=[],w=null;namespace("YE").AStar={aCompute:function(b,c,d){return q(),a(b,c,d)},setDirection:function(a){s=a}}}(),function(){YE.collision=function(){function a(a){return{x1:a.origin.x,y1:a.origin.y,x2:a.origin.x+a.size.width,y2:a.origin.y+a.size.height}}return{col_Between_Rects:function(b,c){var b=a(b),c=a(c);return b&&c&&!(b.x1>=c.x2||b.y1>=c.y2||b.x2<=c.x1||b.y2<=c.y1)?!0:!1}}}()}(),function(){YE.Animation=YYC.Class(YE.Entity,{Init:function(a,b){this.base(),this.ye_frames=a,this.ye_config=b},Private:{ye_frames:null,ye_config:null},Public:{initWhenCreate:function(){var a=this.ye_frames[0].getBitmap(),b=this.ye_config.pixelOffsetX||0,c=this.ye_config.pixelOffsetY||0;this.ye_config.flipX&&a.setFlipX(),this.ye_config.flipY&&a.setFlipY(),a.setAnchor(b,c),this.ye_frames.forEach(function(b){b.setBitmap(a)})},copy:function(){var a=[];return this.ye_frames.forEach(function(b){a.push(b.copy())}),YE.Animation.create(a,YE.Tool.extend.extend({},this.ye_config))},getFrames:function(){return this.ye_frames},getDurationPerFrame:function(){return this.ye_config.duration},getAnimSize:function(){return this.ye_config.size},setFrameIndex:function(a){a.forEach(function(a,b){a.index=b})}},Static:{create:function(a,b){var c=new this(a,b);return c.initWhenCreate(),c}}})}(),function(){var a=null;YE.AnimationCache=YYC.Class(YE.Entity,{Init:function(){this.base(),this.ye_animations=YE.Hash.create()},Private:{ye_animations:null,ye_buildFrameName:function(a,b,c){for(c=c.toString();c.length<b;)c="0"+c;return a+c}},Public:{createAnim:function(a,b,c){var d=null,e=null,f=null,g=0,h=[],i=null,j=null,k=null,l={duration:.1,flipX:!1,flipY:!1,pixelOffsetX:0,pixelOffsetY:0,repeatNum:-1,width:null,height:null},m=0;if(1===arguments.length)k=arguments[0].frames,YE.Tool.extend.extendExist(l,arguments[0]),k.forEach(function(a){h.push(YE.FrameCache.getInstance().getFrame(a))});else if(2===arguments.length)h=[YE.FrameCache.getInstance().getFrame(arguments[0])],YE.Tool.extend.extendExist(l,arguments[1]);else if(3===arguments.length){for(d=a.substring(a.search(/\d+$/),a.length),e=b.substring(b.search(/\d+$/),b.length),f=a.substring(0,a.search(/\d+$/)),g=d.length,d=Number(d),e=Number(e),m=d;e>=m;m++)h.push(YE.FrameCache.getInstance().getFrame(this.ye_buildFrameName(f,g,m)));YE.Tool.extend.extendExist(l,c)}return i=YE.Animation.create(h,{duration:l.duration,flipX:l.flipX,flipY:l.flipY,pixelOffsetX:l.pixelOffsetX,pixelOffsetY:l.pixelOffsetY,size:{width:l.width,height:l.height}}),j=-1===l.repeatNum?YE.RepeatForever.create(YE.Animate.create(i)):YE.Repeat.create(YE.Animate.create(i),l.repeatNum)
},addAnim:function(a,b){this.ye_animations.addChild(a,b)},addAnimWithFile:function(a){var b=null,c=null;b=YE.JsonLoader.getInstance().get(a);for(c in b)b.hasOwnProperty(c)&&this.addAnim(c,this.createAnim(b[c]))},removeAnim:function(a){this.ye_animations.removeChild(a)},getAnim:function(a){return this.ye_animations.getValue(a)}},Static:{getInstance:function(){return null===a&&(a=new this),a}}})}(),function(){YE.AnimationFrame=YYC.Class(YE.Entity,{Init:function(){this.base(),this.ye_spriteFrames=YE.Hash.create()},Private:{ye_spriteFrames:null},Public:{getAnims:function(){return this.ye_spriteFrames.getChilds()},getAnim:function(a){return this.ye_spriteFrames.getValue(a)},addAnim:function(a,b){this.ye_spriteFrames.addChild(a,b)}},Static:{create:function(){return new this}}})}(),function(){YE.AnimationFrameManager=YYC.Class(YE.Entity,{Init:function(){this.ye_animationFrame=YE.AnimationFrame.create()},Private:{ye_animationFrame:null},Public:{initAndReturnAnim:function(a,b){var c=null;return c=YE.Tool.judge.isString(arguments[0])?this.getAnim(arguments[0]):arguments[0],b&&c.setTag(b),c.start(),c},stopAnim:function(a){this.getAnim(a).stop()},startAnim:function(a){this.getAnim(a).start()},getAnim:function(a){return this.ye_animationFrame.getAnim(a)},getAnims:function(){return this.ye_animationFrame.getAnims()},addAnim:function(a,b){b.setTag(a),this.ye_animationFrame.addAnim(a,b)},resetAnim:function(a){this.getAnim(a).reset()}},Static:{create:function(){return new this}}})}(),function(){YE.AnimationManager=YYC.Class(YE.CollectionManager,{Init:function(){this.base()},Public:{},Static:{create:function(){return new this}}})}(),function(){YE.Frame=YYC.Class(YE.Entity,{Init:function(a,b){this.base(),this.ye_bitmap=a,this.ye_rect=b},Private:{ye_bitmap:null,ye_rect:{}},Public:{index:-1,getImg:function(){return this.getBitmap().img},getBitmap:function(){return this.ye_bitmap},setBitmap:function(a){this.ye_bitmap=a},getPixelOffsetX:function(){return this.getBitmap().pixelOffsetX},getPixelOffsetY:function(){return this.getBitmap().pixelOffsetY},setAnchor:function(a,b){this.getBitmap().setAnchor(a,b)},setFlipX:function(){this.getBitmap().setFlipX()},setFlipY:function(){this.getBitmap().setFlipY()},isFlipX:function(){return this.getBitmap().isFlipX()},isFlipY:function(){return this.getBitmap().isFlipY()},getX:function(){return this.ye_rect.origin.x},getY:function(){return this.ye_rect.origin.y},getWidth:function(){return this.ye_rect.size.width},getHeight:function(){return this.ye_rect.size.height},copy:function(){return YE.Frame.create(this.getBitmap().copy(),this.ye_rect)}},Static:{create:function(a,b){return new this(a,b)}}})}(),function(){var a=null;YE.FrameCache=YYC.Class(YE.Entity,{Init:function(){this.base(),this._frames=YE.Hash.create(),this._flags=YE.Hash.create()},Private:{_frames:null,_flags:null,_createFrameAndAddToDict:function(a,b){var c=null,d=null,e=YE.Bitmap.create(a);for(var f in b)if(b.hasOwnProperty(f)){if(this._frames.hasChild(f))continue;c=b[f],d=YE.Frame.create(e,YE.rect(c[0],c[1],c[2],c[3])),this._frames.addChild(f,d)}},_hasFrameData:function(a,b){var c=a+"_"+b;return this._flags.hasChild(c)?!0:(this._flags.addChild(c,1),!1)}},Public:{addFrameData:function(a,b){var c=null,d=null;return this._hasFrameData(a,b)?YE.returnForTest:(c=YE.ImgLoader.getInstance().get(b),d=YE.JsonLoader.getInstance().get(a),YE.error(void 0===c,b+"不存在"),YE.error(void 0===d,a+"不存在"),void this._createFrameAndAddToDict(c,d.frames))},getFrame:function(a){var b=this._frames.getValue(a);return b?b.copy():null}},Static:{getInstance:function(){return null===a&&(a=new this),a}}})}(),function(){var a=null,b={NORMAL:0,PAUSE:1,END:2},c={NONE:0,REQUESTANIMATIONFRAME:1,INTERVAL:2};YE.Director=YYC.Class(YE.Entity,{Init:function(){this.base()},Private:{ye_STARTING_FPS:60,ye_startTime:0,ye_lastTime:0,ye_fps:0,ye_loopInterval:0,ye_lastLoopInterval:0,ye_currentScene:null,ye_loopId:null,ye_loopType:null,ye_isRequestAnimFrameLoopAdded:!1,ye_gameState:null,ye_timerIndex:0,ye_endLoop:!1,ye_getTimeNow:function(){return+new Date},ye_loopBody:function(a){this.ye_tick(a),this.ye_currentScene.startLoop(),this.ye_currentScene.run(),this.ye_currentScene.endLoop()},ye_tick:function(a){this.ye_updateFps(a),this.gameTime=(this.ye_getTimeNow()-this.ye_startTime)/1e3,this.ye_lastTime=a},ye_updateFps:function(a){return this.ye_loopType===c.INTERVAL?void(this.ye_fps=1/this.ye_loopInterval):void(this.ye_fps=0===this.ye_lastTime?this.ye_STARTING_FPS:1e3/(a-this.ye_lastTime))},ye_isToUseIntervalLoop:function(){return this.ye_loopInterval!==1/this.ye_STARTING_FPS},ye_startLoop:function(){var a=this,b=null;if(this.ye_isToUseIntervalLoop())this.ye_loopId=window.setInterval(function(){a.ye_loopBody(a.ye_getTimeNow())},1e3*this.ye_loopInterval),this.ye_loopType=c.INTERVAL;else{if(this.ye_endLoop=!1,this.ye_isRequestAnimFrameLoopAdded)return YE.returnForTest;b=function(c){return a.ye_loopBody(c),a.ye_endLoop?void(a.ye_isRequestAnimFrameLoopAdded=!1):void(a.ye_loopId=window.requestNextAnimationFrame(b))},this.ye_loopId=window.requestNextAnimationFrame(b),this.ye_loopType=c.REQUESTANIMATIONFRAME}this.ye_isRequestAnimFrameLoopAdded=!0},ye_endNextLoop:function(){window.clearInterval(this.ye_loopId),this.ye_endLoop=!0},ye_restart:function(){this.ye_endNextLoop(),this.ye_startLoop()}},Public:{gameTime:0,initWhenCreate:function(){this.ye_loopInterval=1/this.ye_STARTING_FPS},runWithScene:function(a){a.init(this),this.setCurrentScene(a),this.ye_startTime=this.ye_getTimeNow(),this.ye_gameState=b.NORMAL,this.ye_startLoop()},setCurrentScene:function(a){this.ye_currentScene&&this.ye_currentScene.onExit(),this.ye_currentScene=a,a.onEnter()},getCurrentScene:function(){return this.ye_currentScene},getFps:function(){return this.ye_fps},getPixPerFrame:function(a){return YE.main.getConfig().isDebug?a/this.ye_STARTING_FPS:a/this.ye_fps},end:function(){this.ye_endNextLoop(),this.ye_gameState=b.END,YE.Tool.asyn.clearAllTimer(this.ye_timerIndex)},pause:function(){return this.ye_gameState===b.PAUSE?YE.returnForTest:(this.ye_lastLoopInterval=this.ye_loopInterval,this.ye_endNextLoop(),void(this.ye_gameState=b.PAUSE))},resume:function(){return this.ye_gameState!==b.PAUSE?YE.returnForTest:(this.ye_loopInterval=this.ye_lastLoopInterval,this.ye_restart(),void(this.ye_gameState=b.NORMAL))},setLoopIntervalAndRestart:function(a){this.ye_loopInterval=a,this.ye_restart()},resumeRequestAnimFrameLoop:function(){this.ye_loopInterval=1/this.ye_STARTING_FPS,this.ye_restart()},setTimerIndex:function(a){this.ye_timerIndex=a},forTest_getGameState:function(){return b},forTest_getLoopType:function(){return c}},Static:{getInstance:function(){return null===a&&(a=new this,a.initWhenCreate()),a}}})}(),function(){var a={NORMAL:0,CHANGE:1};YE.Layer=YYC.AClass(YE.NodeContainer,{Init:function(b,c){this.base(),b&&this.setCanvasById(b),c&&this.setPosition(c.x,c.y),!b&&c&&YE.error("请传入画布id"),this.ye___state=this.isChange()?a.CHANGE:a.NORMAL},Private:{ye___graphics:null,ye___state:null,ye___context:null,ye___canvas:null,ye___runInterval:-1,ye___lastTime:0,ye___getContext:function(){this.ye___context=this.ye___canvas.getContext("2d")},ye___isChange:function(){return this.ye___state===a.CHANGE},ye___isNormal:function(){return this.ye___state===a.NORMAL},ye___clearCanvas:function(){var a=this.getCanvasData();this.ye___context.clearRect(0,0,a.width,a.height)},ye___getDurationFromLastLoop:function(){return this.ye___getTimeNow()-this.ye___lastTime},ye___getTimeNow:function(){return+new Date},ye___isTimeToRun:function(){return this.ye___getDurationFromLastLoop()>=1e3*this.ye___runInterval}},Protected:{ye_P_run:function(){this.iterate("update"),this.ye___isChange()&&(this.clear(),this.iterate("onBeforeDraw",[this.getContext()]),this.draw(this.getContext()),this.iterate("onAfterDraw",[this.getContext()]),this.setStateNormal()),this.change()}},Public:{setStateNormal:function(){this.ye___state=a.NORMAL},setStateChange:function(){this.ye___state=a.CHANGE},setZIndex:function(a){this.ye___canvas.style.zIndex=a},getZIndex:function(){return Number(this.ye___canvas.style.zIndex)},setCanvasById:function(a){var b=document.getElementById(a);YE.error(!b,"没有找到"+a),this.ye___canvas=b,this.ye___getContext()},setWidth:function(a){this.ye___canvas.width=a},setHeight:function(a){this.ye___canvas.height=a},setPosition:function(a,b,c){this.ye___canvas.style.position=c||"absolute",this.ye___canvas.style.top=b.toString()+"px",this.ye___canvas.style.left=a.toString()+"px"},getContext:function(){return this.ye___context},getGraphics:function(){return this.ye___graphics||(this.ye___graphics=YE.Graphics.create(this.getContext())),this.ye___graphics},change:function(){this.isChange()===!0?this.setStateChange():this.setStateNormal()},getCanvasData:function(){return{width:this.ye___canvas.width,height:this.ye___canvas.height}},isSetRunInterval:function(){return-1!==this.ye___runInterval},setRunInterval:function(a){this.ye___runInterval=a,this.ye___lastTime=this.ye___getTimeNow()},changeRunInterval:function(a){this.ye___runInterval=a},resumeRunInterval:function(){this.ye___runInterval=-1},run:function(){if(this.isSetRunInterval()){if(!this.ye___isTimeToRun())return YE.returnForTest;this.ye___lastTime=this.ye___getTimeNow()}this.base()},startLoop:function(){this.onStartLoop(),this.iterate("onStartLoop")},endLoop:function(){this.iterate("onEndLoop"),this.onEndLoop()},Virtual:{clear:function(){this.ye___clearCanvas()},isChange:function(){return!0},draw:function(a){this.iterate("draw",[a||this.getContext()])}},forTest_getState:function(){return a}},Static:{create:function(a,b){var c=YYC.Class(YE.Layer,{Init:function(){this.base(a,b)}});return new c}}})}(),function(){YE.Scene=YYC.AClass(YE.NodeContainer,{Protected:{ye_P_run:function(){this.iterate("run")}},Public:{addChilds:function(a,b,c){this.base(a,b,c),b&&a.map("setZIndex",b)},addChild:function(a,b,c){this.base(a,b,c),b&&a.setZIndex(b)},startLoop:function(){this.onStartLoop(),this.iterate("startLoop")},endLoop:function(){this.iterate("endLoop"),this.onEndLoop()}},Static:{create:function(){var a=YYC.Class(YE.Scene,{Init:function(){this.base()},Public:{}});return new a}}})}(),function(){YE.Sprite=YYC.AClass(YE.Node,{Init:function(a){this.base(),this.setDisplayTarget(a),this.ye___actionManager=YE.ActionManager.create(),this.ye___animationManager=YE.AnimationManager.create(),this.ye___animationFrameManager=YE.AnimationFrameManager.create()},Private:{ye___displayTarget:null,ye___actionManager:null,ye___animationManager:null,ye___animationFrameManager:null,ye___displayFrame:null,ye___x:0,ye___y:0,ye___width:0,ye___height:0,ye___context:null,ye___canvasData:null,ye___offsetX:0,ye___offsetY:0,ye___clipRange:null,ye___setContextAndReturnDrawData:function(a,b,c){var d=0,e=0,f=0,g=0,h=0,i=0,j=this.getCanvasData().width,k=this.getCanvasData().height,l=0,m=0,n=!1,o=!1;return f=b[0]||this.ye___x,g=b[1]||this.ye___y,h=b[2]||this.ye___width,i=b[3]||this.ye___height,a.isInstanceOf(YE.Frame)?(d=a.getPixelOffsetX(),e=a.getPixelOffsetY()):a.isInstanceOf(YE.Bitmap)&&(d=a.pixelOffsetX,e=a.pixelOffsetY),this.ye___clipRange&&this.ye___clip(c),a.isFlipX()&&(c.translate(j,0),c.scale(-1,1),l=j-h-this.ye___computeX(f,d),n=!0),a.isFlipY()&&(c.translate(0,k),c.scale(1,-1),m=k-i-this.ye___computeY(g,e),o=!0),l=n?l:this.ye___computeX(f,d),m=o?m:this.ye___computeY(g,e),[l,m,h,i]},ye___computeX:function(a,b){return a-this.ye___offsetX-b},ye___computeY:function(a,b){return a-this.ye___offsetY-b},ye___clip:function(a){var b=null;a.beginPath(),b=this.ye___clipRange.shift(),a.moveTo(b.x,b.y),this.ye___clipRange.forEach(function(b){a.lineTo(b.x,b.y)}),a.lineTo(b.x,b.y),a.closePath(),a.clip(),this.ye___clipRange=null},ye___drawDisplayTarget:function(a){var b=null,c=null,d=[],e=null;a.save(),e=this.ye___setContextAndReturnDrawData(this.ye___displayTarget,d,a),this.ye___displayTarget.isInstanceOf(YE.Bitmap)?(b=this.ye___displayTarget,a.drawImage(b.img,e[0],e[1],e[2],e[3])):this.ye___displayTarget.isInstanceOf(YE.Frame)&&(c=this.ye___displayTarget,a.drawImage(c.getImg(),c.getX(),c.getY(),c.getWidth(),c.getHeight(),e[0],e[1],e[2],e[3])),a.restore()},ye___drawAnim:function(a){var b=null,c=null;return(b=this.getDisplayFrame())?(a.save(),c=this.ye___setContextAndReturnDrawData(b,this.ye___getAnimData(b),a),this.ye___setSize(c[2],c[3]),a.drawImage(b.getImg(),b.getX(),b.getY(),b.getWidth(),b.getHeight(),c[0],c[1],c[2],c[3]),void a.restore()):"no frame"},ye___getAnimData:function(a){var b=[],c=null;return c=a.getCacheData("animSize"),b=[this.ye___x,this.ye___y],c?(b[2]=void 0!==c.width?c.width:this.ye___width,b[3]=void 0!==c.height?c.height:this.ye___height):(b[2]=this.ye___width,b[3]=this.ye___height),b},ye___setSize:function(a,b){this.ye___width=a,this.ye___height=b},ye___runOnlyOneChild:function(a,b,c,d){return 1===c.getCount()&&(c.hasChild(a)||b&&c.hasChild(b))?YE.returnForTest:(c.removeAllChilds(),void d.call(this,null))}},Public:{init:function(a){this.base(a),this.ye___context=a.getContext(),this.ye___graphics=a.getGraphics(),this.ye___canvasData=a.getCanvasData()},getContext:function(){return this.ye___context},getGraphics:function(){return this.ye___graphics},getCanvasData:function(){return this.ye___canvasData},runAction:function(a,b){return b&&a.setTag(b),this.ye___actionManager.hasChild(a)||b&&this.ye___actionManager.hasChild(b)?YE.returnForTest:void this.ye___actionManager.addChild(a,this)},update:function(){this.ye___actionManager.update(),this.ye___animationManager.update()},setPosition:function(a,b){this.ye___x=a,this.ye___y=b},setPositionX:function(a){this.ye___x=a},setPositionY:function(a){this.ye___y=a},getPositionX:function(){return this.ye___x},getPositionY:function(){return this.ye___y},getAnimationFrameManager:function(){return this.ye___animationFrameManager},getActionManager:function(){return this.ye___actionManager},setDisplayFrame:function(a){this.ye___displayFrame=a},getDisplayFrame:function(){return this.ye___displayFrame},runOnlyOneAnim:function(a,b){return this.ye___runOnlyOneChild(a,b,this.ye___animationManager,function(){this.ye___animationManager.addChild(this.ye___animationFrameManager.initAndReturnAnim(a,b),this)})},runOnlyOneAction:function(a,b){return this.ye___runOnlyOneChild(a,b,this.ye___actionManager,function(){this.runAction(a,b)})},getCurrentAnim:function(){return this.ye___animationManager.getChilds()[0]},getCurrentActions:function(){return this.ye___actionManager.getChilds()},getCurrentAction:function(){var a=this.getCurrentActions();return YE.error(0===a.length,"没有运行的动作"),YE.assert(1===a.length,"当前运行的动作不止一个"),a[a.length-1]},removeAllActions:function(a){this.ye___actionManager.removeAllChilds(a)},removeAllAnims:function(a){this.ye___animationManager.removeAllChilds(a)},isCurrentAnimExactly:function(a){return this.ye___animationManager.hasChild(a)},isCurrentAnim:function(a){var b=null;return b=this.getCurrentAnim(),b?b.containTag(a):!1},getWidth:function(){return this.ye___width},getHeight:function(){return this.ye___height},setWidth:function(a){this.ye___width=a},setHeight:function(a){this.ye___height=a},setDisplayTarget:function(a){this.ye___displayTarget=a},setOffsetX:function(a){this.ye___offsetX=a},setOffsetY:function(a){this.ye___offsetY=a},getOffsetX:function(){return this.ye___offsetX},getOffsetY:function(){return this.ye___offsetY},setClipRange:function(a){this.ye___clipRange=a},Virtual:{draw:function(a){var b=null;return this.ye___displayTarget?(this.ye___drawDisplayTarget(a),YE.returnForTest):b=this.ye___drawAnim(a)},clear:function(a){a.clearRect(this.ye___x,this.ye___y,this.ye___width,this.ye___height)},onBeforeDraw:function(){},onAfterDraw:function(){}}},Static:{create:function(a){var b=YYC.Class(YE.Sprite,{Init:function(a){this.base(a)},Public:{}});return new b(a)}}})}(),function(){YE.Event={KEY_DOWN:0,KEY_UP:1,KEY_PRESS:2,MOUSE_MOVE:3,MOUSE_OUT:4,MOUSE_OVER:5,MOUSE_DOWN:6,MOUSE_UP:7,CLICK:8,CONTEXTMENU:9,KeyCodeMap:{A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,SPACE:32}}}(),function(){var a={};YE.EventManager={_getEventType:function(a){var b="",c=YE.Event;switch(a){case c.KEY_DOWN:b="keydown";break;case c.KEY_UP:b="keyup";break;case c.KEY_PRESS:b="keypress";break;case c.MOUSE_MOVE:b="mousemove";break;case c.MOUSE_OVER:b="mouseover";break;case c.MOUSE_OUT:b="mouseout";break;case c.MOUSE_DOWN:b="mousedown";break;case c.MOUSE_UP:b="mouseup";break;case c.CLICK:b="click";break;case c.CONTEXTMENU:b="contextmenu";break;default:YE.error(!0,"事件类型错误")}return b},addListener:function(a,b,c,d){var e="",f=null;e=this._getEventType(a),f=d?YE.Tool.event.bindEvent(d,b):b,YE.Tool.event.addEvent(c||window,e,f),this._registerEvent(e,f,c||window)},_registerEvent:function(b,c,d){void 0===a[b]?a[b]=[[c,d]]:a[b].push([c,d])},removeListener:function(b){var c="";c=this._getEventType(b),a[c]&&(a[c].forEach(function(a){YE.Tool.event.removeEvent(a[1],c,a[0])}),a[c]=void 0)},removeAllListener:function(){var b=null;for(b in a)a[b].forEach(function(a){YE.Tool.event.removeEvent(a[1],b,a[0])});a={}}}}(),function(){function a(){try{var a=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext;a?(f=new a,e=c.WEBAUDIO):b()}catch(d){b()}}function b(){if("undefined"!=typeof Audio)try{new Audio,e=c.HTML5AUDIO}catch(a){e=c.NONE}else e=c.HTML5AUDIO}var c={NONE:0,WEBAUDIO:1,HTML5AUDIO:2},d={NONE:0,PLAYING:1,END:2},e=null,f=null,g=null,h=null,i=null,j=null;a();var k=YYC.Class({Init:function(a){this.ye_config=a},Private:{ye_config:null},Public:{initWhenCreate:function(){switch(e){case c.WEBAUDIO:g=i.create(this.ye_config);break;case c.HTML5AUDIO:g=j.create(this.ye_config);break;case c.NONE:return YE.log("浏览器不支持Web Audio和Html5 Audio"),YE.returnForTest;default:return YE.returnForTest}g.load()},play:function(){g.play()},getPlayState:function(){return g.getPlayState()},forTest_setAudioObj:function(a){g=a},forTest_setAudioType:function(a){e=a},forTest_getAudioTypeEnum:function(){return c},forTest_getPlayStateEnum:function(){return d},forTest_getAudioBase:function(){return h},forTest_getWebAudio:function(){return i},forTest_getHtml5Audio:function(){return j}},Static:{create:function(a){var b=new this(a);return b.initWhenCreate(),b}}});!function(){h=YYC.AClass({Private:{ye_getCanPlayUrl:function(){var a=this,b=null;return this.ye_P_urlArr.forEach(function(c){var d=c.match(/\.(\w+)$/);return null===d?(YE.error(!0,"声音url错误，必须加上类型后缀名"),$break):a.ye_canplay(d[1])?(b=c,$break):void 0}),null===b?void YE.error(!0,"浏览器不支持该声音格式"):b},ye_canplay:function(a){var b=new Audio,c=null;switch(a){case"mp3":c="audio/mpeg";break;case"wav":c="audio/wav";break;default:YE.error(!0,"声音类型错误")}return"mp3"==a&&YE.Tool.judge.browser.isFF()?!1:!!b.canPlayType&&""!==b.canPlayType(c)}},Protected:{ye_P_urlArr:null,ye_P_url:null},Public:{initWhenCreate:function(){this.ye_P_url=this.ye_getCanPlayUrl()}},Abstract:{play:function(){},load:function(){},getPlayState:function(){}}}),i=YYC.Class(h,{Init:function(a){this.ye__config=a,this.ye_P_urlArr=a.urlArr,this.ye__onLoad=a.onLoad,this.ye__onError=a.onError},Private:{ye__buffer:null,ye__bufferSource:null,ye__onLoad:null,ye__onError:null,ye__config:null,ye__playState:null,ye__loadBuffer:function(a,b){var c=this;YE.$.ajax({type:"get",url:b,dataType:"arraybuffer",success:function(b){c.ye__decodeAudioData(b,a)},error:function(){YE.log("使用Web Audio加载失败！尝试使用Html5 Audio加载"),g=j.create(c.ye__config),g.load()}})},ye__decodeAudioData:function(a,b){var c=this;f.decodeAudioData(a,function(a){a&&(c.ye__buffer=a,c.ye__onLoad(c))},function(a){b.ye__onError(a.err)})}},Public:{initWhenCreate:function(){this.base(),this.ye__playState=d.NONE},load:function(){this.ye__loadBuffer(this,this.ye_P_url)},play:function(){var a=f.createBufferSource(),b=this;a.buffer=this.ye__buffer,a.connect(f.destination),a.start(0),this.ye__playState=d.PLAYING,setTimeout(function(){b.ye__playState=d.END},1e3*this.ye__buffer.duration)},getPlayState:function(){return this.ye__playState},forTest_setAudioContext:function(a){f=a}},Static:{create:function(a){var b=new this(a);return b.initWhenCreate(),b}}}),j=YYC.Class(h,{Init:function(a){this.ye_P_urlArr=a.urlArr,this.ye__onLoad=a.onLoad,this.ye__onError=a.onError},Private:{ye__audio:null,ye__onLoad:null,ye__onError:null,ye__load:function(){this.ye__audio.src=this.ye_P_url}},Public:{load:function(){var a=this;this.ye__audio=new Audio,this.ye__audio.addEventListener("canplaythrough",function(){a.ye__onLoad(a)},!1),this.ye__audio.addEventListener("error",function(){a.ye__onError("errorCode "+a.ye__audio.error.code)},!1),this.ye__audio.addEventListener("ended",function(){YE.Tool.judge.browser.isChrome()?this.load():YE.Tool.judge.browser.isFF()?this.currentTime=0:YE.error(!0,"目前仅支持Chrome、Firefox浏览器")},!1),this.ye__load()},play:function(){this.ye__audio.play()},getPlayState:function(){var a=0;return a=this.ye__audio.ended?d.END:this.ye__audio.currentTime>0?d.PLAYING:d.NONE}},Static:{create:function(a){var b=new this(a);return b.initWhenCreate(),b}}})}(),YE.YSound=k}(),function(){var a=null;YE.ImgLoader=YYC.Class(YE.Loader,{Init:function(){this.base()},Protected:{ye_P_load:function(a,b){var c=null,d=this;c=new Image,c.onload=function(){this.onload=null,d.ye_P_container.addChild(b,this),YE.LoaderManager.getInstance().onResLoaded()},c.onerror=function(){YE.LoaderManager.getInstance().onResError(a)},c.src=a}},Static:{getInstance:function(){return null===a&&(a=new this),a}}})}(),function(){var a=null;YE.JsonLoader=YYC.Class(YE.Loader,{Init:function(){this.base()},Protected:{ye_P_load:function(a,b){var c=this;YE.$.ajax({type:"get",url:a,contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){c.ye_P_container.addChild(b,a),YE.LoaderManager.getInstance().onResLoaded()},error:function(b,c){YE.LoaderManager.getInstance().onResError(a,"readyState:"+b.readyState+"\nstatus:"+b.status+"\nmessage:"+c.message+"\nresponseText:"+b.responseText)}})}},Static:{getInstance:function(){return null===a&&(a=new this),a}}})}(),function(){var a=null;YE.LoaderManager=YYC.Class(YE.Entity,{Init:function(){this.base()},Private:{ye_resCount:0,ye_currentLoadedCount:0,ye_isFinishLoad:function(){var a=this;this.getCurrentLoadedCount()===this.getResourceCount()?this.onload?this.onload():YE.assert(!1,"没有定义onload"):(this.onloading&&setTimeout(function(){a.onloading(a.getCurrentLoadedCount(),a.getResourceCount())},16),setTimeout(function(){a.ye_isFinishLoad.call(a)},16))}},Public:{getResourceCount:function(){return this.ye_resCount},getCurrentLoadedCount:function(){return this.ye_currentLoadedCount},preload:function(a){var b=this;a.forEach(function(a){switch(a.type){case"image":YE.ImgLoader.getInstance().load(a.url,a.id),b.ye_resCount+=1;break;case"json":YE.JsonLoader.getInstance().load(a.url,a.id),b.ye_resCount+=1;break;case"sound":YE.SoundLoader.getInstance().load(a.url,a.id),b.ye_resCount+=1;break;default:YE.error(!0,"type错误")}}),this.ye_isFinishLoad()},reset:function(){this.ye_resCount=0,this.ye_currentLoadedCount=0},onResLoaded:function(){this.ye_currentLoadedCount+=1},onResError:function(a,b){YE.log("加载"+a+"资源失败"),b&&YE.log(b)},onloading:void 0,onload:void 0},Static:{getInstance:function(){return null===a&&(a=new this),a}}})}(),function(){var a=null;YE.SoundLoader=YYC.Class(YE.Loader,{Init:function(){this.base()},Protected:{ye_P_load:function(a,b){var c=this;YE.YSound.create({urlArr:a,onLoad:function(a){YE.LoaderManager.getInstance().onResLoaded(),c.ye_P_container.appendChild(b,a)},onError:function(b){YE.LoaderManager.getInstance().onResError(a,"错误原因："+b)}})}},Static:{getInstance:function(){return null===a&&(a=new this),a}}})}(),function(){var a=null;YE.SoundManager=YYC.Class(YE.Entity,{Init:function(){this.base()},Private:{ye_counter:0,ye_playOnlyOneSimultaneously:function(a){1!==a.getPlayState()&&a.play()}},Public:{play:function(a){var b=YE.SoundLoader.getInstance().get(a),c=null;return b&&0!==b.length?(this.ye_counter>=b.length&&(this.ye_counter=0),c=b[this.ye_counter],this.ye_counter++,void this.ye_playOnlyOneSimultaneously(c)):YE.returnForTest}},Static:{getInstance:function(){return null===a&&(a=new this),a}}})}(),function(){YE.Bitmap=YYC.Class(YE.Entity,{Init:function(a){this.base(),this.img=a,this.width=this.img.width,this.height=this.img.height},Private:{ye_isFlipX:!1,ye_isFlipY:!1},Public:{img:null,width:0,height:0,pixelOffsetX:0,pixelOffsetY:0,setFlipX:function(){return this.ye_isFlipX=!0,this},setFlipY:function(){return this.ye_isFlipY=!0,this},isFlipX:function(){return this.ye_isFlipX},isFlipY:function(){return this.ye_isFlipY},setAnchor:function(a,b){return this.pixelOffsetX=a,this.pixelOffsetY=b,this},copy:function(){var a=YE.Bitmap.create(this.img);return YE.Tool.extend.extend(a,this),a}},Static:{create:function(a){return new this(a)}}})}(),function(){YE.Collection=YYC.Class({Init:function(){this.ye_childs=[]},Private:{ye_childs:null},Public:{getCount:function(){return this.ye_childs.length},sort:function(a){this.ye_childs.sort(a)},hasChild:function(a){var b=null;return YE.Tool.judge.isFunction(arguments[0])?(b=arguments[0],this.ye_childs.contain(function(a,c){return b(a,c)})):this.ye_childs.contain(function(b){return b===a||b.getUid&&a.getUid&&b.getUid()===a.getUid()?!0:!1})},getChilds:function(){return this.ye_childs},getChildAt:function(a){return this.ye_childs[a]},addChild:function(a){return this.ye_childs.push(a),this},addChilds:function(a){var b=0,c=0;if(YE.Tool.judge.isArray(a))for(b=0,c=a.length;c>b;b++)this.addChild(a[b]);else this.addChild(a);return this},removeAllChilds:function(){this.ye_childs=[]},forEach:function(){this.ye_childs.forEach.apply(this.ye_childs,arguments)},map:function(){this.ye_childs.map.apply(this.ye_childs,arguments)},filter:function(a){return this.ye_childs.filter(a,this.ye_childs)},removeChildAt:function(a){YE.error(0>a,"序号必须大于等于0"),this.ye_childs.splice(a,1)},copy:function(){return YE.Tool.extend.extendDeep(this.ye_childs)},reverse:function(){this.ye_childs.reverse()},removeChild:function(a,b){return YE.Tool.judge.isFunction(a)?this.ye_childs.removeChild(a,b):this.ye_childs.removeChild(a.isInstanceOf&&a.isInstanceOf(YE.Entity)?function(b){return b.getUid()===a.getUid()}:function(b){return b===a})}},Static:{create:function(){return new this}}})}(),function(){YE.rect=function(a,b,c,d){return{origin:{x:a,y:b},size:{width:c,height:d}}}}(),function(){YE.Hash=YYC.Class({Init:function(){this.ye_childs={}},Private:{ye_childs:null},Public:{getChilds:function(){return this.ye_childs},getValue:function(a){return this.ye_childs[a]},addChild:function(a,b){return this.ye_childs[a]=b,this},appendChild:function(a,b){return YE.Tool.judge.isArray(this.ye_childs[a])?this.ye_childs[a].push(b):this.ye_childs[a]=[b],this},removeChild:function(a){this.ye_childs[a]=void 0},hasChild:function(a){return!!this.ye_childs[a]},forEach:function(a,b){var c=null,d=this.getChilds();for(c in d)if(d.hasOwnProperty(c)&&a.call(b,d[c],c)===$break)break},map:function(a,b){var c=null,d=this.getChilds();for(c in d)d.hasOwnProperty(c)&&d[c][a].apply(d[c],b)}},Static:{create:function(){return new this}}})}(),function(){!function(){window.requestNextAnimationFrame=function(){var a=void 0,b=void 0,c=0,d=navigator.userAgent,e=0,f=this;return b=function(a){a=+new Date,f.callback(a)},window.webkitRequestAnimationFrame&&(a=window.webkitRequestAnimationFrame,window.webkitRequestAnimationFrame=function(c,d){return f.callback=c,a(b,d)}),window.msRequestAnimationFrame&&(a=window.msRequestAnimationFrame,window.msRequestAnimationFrame=function(c){return f.callback=c,a(b)}),window.mozRequestAnimationFrame&&(e=d.indexOf("rv:"),-1!=d.indexOf("Gecko")&&(c=d.substr(e+3,3),"2.0"===c&&(window.mozRequestAnimationFrame=void 0))),window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){var b,c;window.setTimeout(function(){b=+new Date,a(b),c=+new Date,f.timeout=1e3/60-(c-b)},f.timeout)}}(),window.cancelNextRequestAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),function(){var a={};a.extend=function(){return{extend:function(a,b){var c="";for(c in b)a[c]=b[c];return a},extendExist:function(a,b){var c="";for(c in b)void 0!==a[c]&&(a[c]=b[c]);return a},extendNoExist:function(a,b){var c="";for(c in b)void 0===a[c]&&(a[c]=b[c]);return a},extendNoPrototype:function(a,b){var c="";for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},extendDeep:function(a,b){var c=null,d=0,e=Object.prototype.toString,f="[object Array]",g="[object Object]",h="",i=null;if(e.call(a)===f)for(i=b||[],c=0,d=a.length;d>c;c++)h=e.call(a[c]),h===f||h===g?(i[c]=h===f?[]:{},arguments.callee(a[c],i[c])):i[c]=a[c];else if(e.call(a)===g){i=b||{};for(c in a)h=e.call(a[c]),h===f||h===g?(i[c]=h===f?[]:{},arguments.callee(a[c],i[c])):i[c]=a[c]}else i=a;return i}}}(),a.judge=function(){return{browser:{isIE:function(){return!(!document.all||-1!==navigator.userAgent.indexOf("Opera"))},isIE7:function(){return"MSIE 7"==navigator.appVersion.match(/MSIE\s\d/i)},isIE8:function(){return"MSIE 8"==navigator.appVersion.match(/MSIE\s\d/i)},isIE9:function(){return"MSIE 9"==navigator.appVersion.match(/MSIE\s\d/i)},isFF:function(){return navigator.userAgent.indexOf("Firefox")>=0&&!0},isOpera:function(){return navigator.userAgent.indexOf("Opera")>=0&&!0},isChrome:function(){return navigator.userAgent.indexOf("Chrome")>=0&&!0}},isjQuery:function(a){return window.jQuery?a instanceof window.jQuery:!1},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isDate:function(a){return"[object Date]"===Object.prototype.toString.call(a)},isString:function(a){return"[object String]"===Object.prototype.toString.call(a)},isOwnEmptyObject:function(a){var b="";for(b in a)if(a.hasOwnProperty(b))return!1;return!0},isEmptyObject:function(a){var b="";for(b in a)return!1;return!0},isOdd:function(a){return a%2!==0},isDirectObject:function(a){return"[object Object]"===Object.prototype.toString.call(a)?!0:!1},isHTMLImg:function(a){return"[object HTMLImageElement]"===Object.prototype.toString.call(a)},isDom:function(a){return a instanceof HTMLElement},isNumber:function(a){return"[object Number]"===Object.prototype.toString.call(a)},isBool:function(a){return"[object Boolean]"===Object.prototype.toString.call(a)},isHostMethod:function(){function a(a,b){var c=typeof a[b];return"function"===c||"object"===c&&!!a[b]||"unknown"===c}return a}(),isChildOf:function(a,b){return $(a).parents(b).length>=1}}}(),a.asyn=function(){return{clearAllTimer:function(a){var b=0,c=0,d=250,e=0;for(e=a-d>=1?a-d:1,c=e+2*d,b=e;c>b;b++)window.clearTimeout(b);for(b=e;c>b;b++)window.clearInterval(b)}}}(),a.event=function(){return{bindEvent:function(a,b){var c=Array.prototype.slice.call(arguments,2),d=this;return function(e){return b.apply(a,[d.wrapEvent(e)].concat(c))}},addEvent:function(b,c,d){var e=null;a.judge.isjQuery(b)?b.each(function(){e=this,a.judge.isHostMethod(e,"addEventListener")?e.addEventListener(c,d,!1):a.judge.isHostMethod(e,"attachEvent")?e.attachEvent("on"+c,d):e["on"+c]=d}):(e=b,a.judge.isHostMethod(e,"addEventListener")?e.addEventListener(c,d,!1):a.judge.isHostMethod(e,"attachEvent")?e.attachEvent("on"+c,d):e["on"+c]=d)},removeEvent:function(b,c,d){var e=null;a.judge.isjQuery(b)?b.each(function(){e=this,a.judge.isHostMethod(e,"removeEventListener")?e.removeEventListener(c,d,!1):a.judge.isHostMethod(e,"detachEvent")?e.detachEvent("on"+c,d):e["on"+c]=null}):(e=b,a.judge.isHostMethod(e,"removeEventListener")?e.removeEventListener(c,d,!1):a.judge.isHostMethod(e,"detachEvent")?e.detachEvent("on"+c,d):e["on"+c]=null)},wrapEvent:function(b){var c=b?b:global.event,d=c.srcElement||c.target;if(a.judge.browser.isIE())if(c.pageX=c.clientX+document.body.scrollLeft||document.documentElement.scrollLeft,c.pageY=c.clientY+document.body.scrollTop||document.documentElement.scrollTop,c.stopBubble=function(){c.cancelBubble=!0
},a.judge.browser.isIE7()||a.judge.browser.isIE8())switch(c.preventDefault=function(){c.returnValue=!1},"mouseout"==c.type?c.relatedTarget=c.toElement:"mouseover"==c.type&&(c.relatedTarget=c.fromElement),c.button){case 1:c.mouseButton=0;break;case 4:c.mouseButton=1;break;case 2:c.mouseButton=2;break;default:c.mouseButton=c.button}else c.mouseButton=c.button;else c.stopBubble=c.stopPropagation,c.keyCode=c.which,c.mouseButton=c.button;return c.target=d,c},getEvent:function(){return this.getEvent.caller.arguments[0]},triggerEvent:function(b,c){var d=null,e=null;a.judge.isHostMethod(document,"createEvent")?(d=document.createEvent("Events"),d.initEvent(c,!1,!0),a.judge.isjQuery(b)?b.each(function(){e=this,e.dispatchEvent(d)}):(e=b,e.dispatchEvent(d))):a.judge.isHostMethod(document,"createEventObject")&&(a.judge.isjQuery(b)?b.each(function(){e=this,e.fireEvent("on"+c)}):(e=b,e.fireEvent("on"+c)))}}}(),a.path=function(){return{getJsDir:function(a){var b=$("script[src*='"+a+"']").attr("src");return b.substring(0,b.lastIndexOf("/")+1)}}}(),a.collection=function(){return{getChildByTag:function(a,b){var c=null,d=YE.Tool.judge.isArray(b)?b:[b],e=null,f={};try{a.forEach(function(a){c=a.getTag(),c&&d.forEach(function(b){c.forEach(function(c){if(c===b)throw e=a,f})})})}catch(g){if(g!==f)throw g}return e},getChildsByTag:function(a,b){var c=null,d=!1,e=YE.Tool.judge.isArray(b)?b:[b],f={};return a.filter(function(a){if(d=!1,c=a.getTag()){try{e.forEach(function(a){c.forEach(function(b){if(b===a)throw d=!0,f})})}catch(b){if(b!==f)throw b}return d}})},removeChildByTag:function(a,b,c){var d=null,e=!1,f=YE.Tool.judge.isArray(b)?b:[b],g={};a.removeChild(function(a){if(e=!1,d=a.getTag(),!d)return!1;try{f.forEach(function(b){d.forEach(function(d){if(d===b)throw e=!0,c&&c(a),g})})}catch(b){if(b!==g)throw b}return e})},removeChildsByTag:function(a,b,c){var d=null,e=YE.Tool.judge.isArray(b)?b:[b],f=[],g={};a.forEach(function(a){if(d=a.getTag(),!d)return void f.push(a);try{e.forEach(function(b){d.forEach(function(d){if(d===b)throw c&&c(a),g})}),f.push(a)}catch(b){if(b!==g)throw b}}),a.removeAllChilds(),a.addChilds(f)}}}(),YE.Tool=a}()}(),function(){YE.Graphics=YYC.Class(YE.Entity,{Init:function(a){this.base(),this.ye_context=a},Private:{ye_context:null,ye_buildDiamondBox:function(a,b,c){var d=a,e=[a[0]+c*Math.cos(b),a[1]-c*Math.sin(b)],f=[a[0]+c*Math.cos(b)*2,a[1]],g=[a[0]+c*Math.cos(b),a[1]+c*Math.sin(b)];return[d,e,f,g]}},Public:{setContext:function(a){this.ye_context=a},drawPolygon:function(a,b,c){var d=0,e=c.length;for(this.ye_context.strokeStyle=a,this.ye_context.lineWidth=b,this.ye_context.beginPath(),this.ye_context.moveTo(c[0][0],c[0][1]),d=1;e>d;d++)this.ye_context.lineTo(c[d][0],c[d][1]);this.ye_context.lineTo(c[0][0],c[0][1]),this.ye_context.closePath(),this.ye_context.stroke()},fillPolygon:function(a,b){var c=0,d=b.length;for(this.ye_context.fillStyle=a,this.ye_context.beginPath(),this.ye_context.moveTo(b[0][0],b[0][1]),c=1;d>c;c++)this.ye_context.lineTo(b[c][0],b[c][1]);this.ye_context.lineTo(b[0][0],b[0][1]),this.ye_context.closePath(),this.ye_context.fill()},fillMultiplePolygon:function(a,b){var c=this;this.ye_context.fillStyle=a,this.ye_context.beginPath(),b.forEach(function(a){c.ye_context.moveTo(a[0][0],a[0][1]),a.forEach(function(a){c.ye_context.lineTo(a[0],a[1])}),c.ye_context.lineTo(a[0][0],a[0][1])}),this.ye_context.closePath(),this.ye_context.fill()},drawCircle:function(a,b,c,d,e){this.ye_context.strokeStyle=a,this.ye_context.lineWidth=b,this.ye_context.beginPath(),this.ye_context.arc(c,d,e,0,2*Math.PI,!1),this.ye_context.stroke()},fillCircle:function(a,b,c,d){this.ye_context.fillStyle=a,this.ye_context.beginPath(),this.ye_context.arc(b,c,d,0,2*Math.PI,!1),this.ye_context.fill()},drawDiamondBox:function(a,b,c,d,e){this.drawPolygon(a,b,this.ye_buildDiamondBox(c,d,e))},fillDiamondBox:function(a,b,c,d){this.fillPolygon(a,this.ye_buildDiamondBox(b,c,d))},fillMultipleDiamondBox:function(a,b,c,d){var e=[],f=this;b.forEach(function(a){e.push(f.ye_buildDiamondBox(a,c,d))}),this.fillMultiplePolygon(a,e)},drawLifeBar:function(a,b,c,d,e){this.ye_context.strokeStyle=d,this.ye_context.lineWidth=b,this.ye_context.strokeRect(a[0],a[1],a[2],a[3]),this.ye_context.fillStyle=e,this.ye_context.fillRect(a[0],a[1],c,a[3])}},Static:{create:function(a){return new this(a)}}})}();